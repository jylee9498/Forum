<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="/main.css" rel="stylesheet">
</head>
<body class ="grey-bg">

    <%- include("nav.ejs") %>

    <div class="white-bg">
        <% for (let i = 0; i < posts.length; i++){ %>
        <div class="list-box">
            <%= JSON.stringify(posts[i]._id) %>
            <h4>
                <a href = "/detail/<%= posts[i]._id%>">
                    <%= posts[i].title%> 
                </a>
                <a href = "/edit/<%= posts[i]._id%>">âœï¸ </a>
                <span class ="delete" data-id="<%= posts[i]._id %>">ğŸ—‘ï¸</span>
            </h4>
            <p><%= posts[i].content%></p>
        </div>
        <%} %>
    </div>
    <script>
        // document.querySelectorAll(".delete")[0].addEventListener("click", function(){
        //     fetch("/delete", {         // fetchë¥¼ ì‚¬ìš©í•˜ë©´ ajaxì´ìš©í•˜ëŠ” ê²ƒ.(?) fetch("url")ì€ ìƒˆë¡œê³ ì¹¨ ì—†ì´ë„ GETìš”ì²­í•¨.
        //         method : "DELETE",    // methodì— Postë¥¼ ì‚¬ìš©í•˜ë©´ ìƒˆë¡œê³ ì¹¨ ì—†ì–´ë„ Post ìš”ì²­
        //         headers : {
        //             "Content-Type" : "application/json"
        //         },
        //         body : JSON.stringify({
        //             a:1
        //         })// objectë‚˜ arrayë¥¼ ë¬¸ìì—´ë¡œ ë°”ê¿”ì£¼ëŠ” í•¨ìˆ˜
        //     }); 
        // });

        // /* ì„œë²„ë¡œ ì „ì†¡í•  ë•Œ ë‹¤ë¥¸ ë°©ë²• */
        // /*
        //     fetch("/abc/í™ê¸¸ë™")
        //     : urlë¡œ ë°ì´í„° ì „ì†¡, ì„œë²„ì—ì„œëŠ” req.paramsë¡œ ë°ì´í„° íšë“ ê°€ëŠ¥

        //     fetch("/abc?age=20&name=í™ê¸¸ë™")
        //     : urlë¡œ ë°ì´í„° ì „ì†¡, ì„œë²„ì—ì„œëŠ” req.queryë¡œ ë°ì´í„° íšë“ ê°€ëŠ¥
        //  */
        document.querySelectorAll('.delete')[0].addEventListener('click', function(e){
            fetch('/delete?docid=' + e.target.dataset.id, {
                method:"DELETE"
            });
        });

        document.querySelectorAll('.delete')[1].addEventListener('click', function(e){
            fetch('/delete?docid=' + e.target.dataset.id, {
                method:"DELETE"
            });
        });

        document.querySelectorAll('.delete')[2].addEventListener('click', function(e){
            console.log(e.target.dateset._id)
            fetch('/delete?docid=' + e.target.dataset.id, {
                method:"DELETE"
            });
        });
        
    </script>
</body>
</html>